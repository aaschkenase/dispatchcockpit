<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=0" />
  <title>Tag Driver Pro</title>

  <!-- Favicon (put a file at assets/favicon.png or update path) -->
  <link rel="icon" type="image/png" href="assets/favicon.png">

  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

  <style>
    /* TAG TRANS BRAND THEME */
    :root{
      /* Brand picks (pulled from your logo palette) */
      --tag-teal: #1A4C48;      /* deep teal */
      --tag-teal-2: #0F3532;    /* darker teal */
      --tag-gold: #B6C169;      /* logo gold/olive */
      --tag-gold-2: #D2D98A;    /* lighter gold highlight */

      /* UI system */
      --bg: #071716;
      --bg-2: #0A211F;
      --card: rgba(255,255,255,0.06);
      --card-2: rgba(255,255,255,0.08);
      --border: rgba(182,193,105,0.22);

      --accent: var(--tag-gold);
      --accent-2: var(--tag-teal);
      --text: #F3F6F6;
      --muted: rgba(243,246,246,0.68);

      --success: #22c55e;
      --danger: #ef4444;
      --warning: #f59e0b;

      --shadow: 0 18px 60px rgba(0,0,0,.45);
      --radius: 16px;
    }

    *{box-sizing:border-box;font-family:'Segoe UI',system-ui,sans-serif}
    body{
      margin:0;
      color:var(--text);
      background:
        radial-gradient(1000px 600px at 15% -10%, rgba(182,193,105,0.18), transparent 55%),
        radial-gradient(900px 650px at 115% 20%, rgba(26,76,72,0.35), transparent 55%),
        linear-gradient(180deg, var(--bg), var(--bg-2));
      padding-bottom:50px;
    }

    .container{max-width:1400px;margin:0 auto;padding:16px}

    /* Header */
    .topbar{
      display:flex;justify-content:space-between;align-items:center;gap:14px;
      margin-bottom:14px;flex-wrap:wrap;
      padding:14px 14px;
      border:1px solid var(--border);
      background: rgba(255,255,255,0.04);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      backdrop-filter: blur(8px);
    }
    .brandWrap{display:flex;align-items:center;gap:12px}
    .logo{
      width:46px;height:46px;border-radius:14px;
      border:1px solid rgba(182,193,105,0.35);
      background: rgba(255,255,255,0.07);
      padding:6px;
      display:flex;align-items:center;justify-content:center;
    }
    .logo img{width:100%;height:100%;object-fit:contain;display:block}
    .brandText{display:flex;flex-direction:column;line-height:1.05}
    .brandTitle{
      font-size:20px;font-weight:1000;letter-spacing:-0.7px;
    }
    .brandTitle span{color:var(--accent)}
    .brandSub{font-size:11px;font-weight:900;color:var(--muted);text-transform:uppercase;letter-spacing:1px}

    .pill{
      display:inline-flex;gap:8px;align-items:center;
      padding:9px 12px;border-radius:999px;
      background: rgba(26,76,72,0.25);
      border:1px solid rgba(26,76,72,0.35);
      color: var(--text);
      font-size:12px;font-weight:900;
    }

    /* Controls */
    .controls{display:flex;gap:10px;align-items:flex-end;flex-wrap:wrap}
    .control-block{display:flex;flex-direction:column;gap:6px}
    .mini{font-size:11px;color:var(--muted);font-weight:900}
    select,input{
      width:100%;
      background: rgba(0,0,0,0.25);
      border: 1px solid rgba(182,193,105,0.25);
      color:#fff;
      padding:10px 12px;border-radius:14px;
      font-weight:900;
      outline:none;
      box-shadow: inset 0 0 0 1px rgba(255,255,255,0.03);
    }
    select:focus,input:focus{border-color: rgba(182,193,105,0.55); box-shadow: 0 0 0 4px rgba(182,193,105,0.18)}

    .btnSmall{
      border:1px solid rgba(182,193,105,0.25);
      background: rgba(255,255,255,0.04);
      color:var(--text);
      padding:10px 12px;border-radius:14px;
      cursor:pointer;font-weight:1000;
      transition:.15s;
    }
    .btnSmall:hover{border-color: rgba(182,193,105,0.55); transform: translateY(-1px)}
    .btnSmall.primary{
      background: linear-gradient(135deg, rgba(182,193,105,0.95), rgba(210,217,138,0.85));
      border-color: rgba(182,193,105,0.9);
      color:#071716;
    }
    .btnSmall.primary:hover{filter:brightness(1.03)}
    .btnSmall.danger{border-color: rgba(239,68,68,0.55); color:#fecaca}
    .btnSmall.danger:hover{background: rgba(239,68,68,0.22); border-color: rgba(239,68,68,0.8)}

    /* Status/warn */
    .status-msg{
      font-size:12px;color: #1a4c48;
      display:none;font-weight:1000;
      background: rgba(182,193,105,0.85);
      padding:10px 12px;border-radius:14px;
      border:1px solid rgba(182,193,105,0.9);
    }
    .warn-banner{
      display:none;margin:14px 0;padding:12px 14px;border-radius:16px;
      border:1px solid rgba(239,68,68,0.35);background:rgba(239,68,68,0.12);
      font-weight:1000;color:#fecaca
    }
    .warn-banner b{color:#fff}

    /* Nav */
    nav{
      display:flex;gap:10px;margin:14px 0;
      border:1px solid rgba(182,193,105,0.20);
      background: rgba(255,255,255,0.04);
      padding:10px;border-radius: var(--radius);
      overflow-x:auto;
    }
    .nav-btn{
      padding:10px 16px;border:none;cursor:pointer;
      color:var(--muted);font-weight:1000;border-radius:14px;
      background: transparent; transition:.15s; white-space:nowrap;
    }
    .nav-btn:hover{background: rgba(182,193,105,0.10); color: var(--text)}
    .nav-btn.active{
      background: linear-gradient(135deg, rgba(26,76,72,0.75), rgba(15,53,50,0.65));
      color: #EAF2F2;
      border: 1px solid rgba(26,76,72,0.55);
      box-shadow: 0 10px 26px rgba(0,0,0,.25);
    }
    .tab-content{display:none}
    .tab-content.active{display:block}

    /* Layout */
    .dash-grid{display:grid;grid-template-columns:420px 1fr;gap:20px}
    @media (max-width:1050px){.dash-grid{grid-template-columns:1fr}}

    /* Cards */
    .card{
      border:1px solid var(--border);
      background: var(--card);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      overflow:hidden;
      backdrop-filter: blur(8px);
      margin-bottom:20px;
    }
    .card-header{
      background: rgba(26,76,72,0.22);
      border-bottom: 1px solid rgba(182,193,105,0.18);
      padding:12px 15px;
      font-weight:1100;font-size:12px;color: var(--accent);
      text-transform:uppercase;letter-spacing:1px;
    }
    .card-body{padding:15px}

    /* Inputs */
    .input-row{display:flex;gap:10px;margin-bottom:12px}
    .input-group{flex:1}
    label{display:block;font-size:11px;color:var(--muted);margin-bottom:4px;font-weight:1000;text-transform:uppercase;letter-spacing:.8px}

    /* Stats */
    .stats-bar{display:grid;grid-template-columns:repeat(auto-fit,minmax(190px,1fr));gap:14px;margin:10px 0 18px}
    .stat-box{
      background: var(--card-2);
      border:1px solid rgba(182,193,105,0.18);
      padding:14px;border-radius: var(--radius);
      box-shadow: 0 14px 40px rgba(0,0,0,.28);
    }
    .stat-label{font-size:11px;color:var(--muted);text-transform:uppercase;font-weight:1000;letter-spacing:.9px}
    .stat-val{font-size:24px;font-weight:1200}
    .pos{color:var(--accent)} /* brand accent for positive */
    .neg{color:#ffb4b4}

    /* Map */
    #map{
      height:520px;width:100%;
      border-radius: var(--radius);
      border:1px solid rgba(182,193,105,0.22);
      z-index:0;
    }

    /* Table */
    table{width:100%;border-collapse:collapse;font-size:13px}
    th{
      text-align:left;color:var(--muted);padding:10px;
      border-bottom:1px solid rgba(182,193,105,0.18);
      font-size:11px;text-transform:uppercase;font-weight:1100;letter-spacing:.9px
    }
    td{padding:10px;border-bottom:1px solid rgba(182,193,105,0.10)}
    tr:hover td{background: rgba(182,193,105,0.05)}

    .action-btn{
      background: transparent;
      border: 1px solid rgba(182,193,105,0.35);
      color: var(--accent);
      cursor:pointer;
      padding:6px 10px;border-radius:12px;
      font-size:11px;font-weight:1100;text-transform:uppercase;
      transition:.15s;
    }
    .action-btn:hover{
      background: rgba(182,193,105,0.18);
      border-color: rgba(182,193,105,0.65);
      transform: translateY(-1px);
    }
    .delete-btn{
      color:#fecaca;border-color: rgba(239,68,68,0.55);
    }
    .delete-btn:hover{background: rgba(239,68,68,0.20); border-color: rgba(239,68,68,0.85)}

    /* Buttons */
    .btn{width:100%;padding:12px;border:none;border-radius:14px;font-weight:1100;cursor:pointer;margin-top:10px}
    .btn-primary{
      background: linear-gradient(135deg, rgba(182,193,105,0.98), rgba(210,217,138,0.86));
      color:#071716;
      box-shadow: 0 12px 26px rgba(182,193,105,0.18);
    }
    .btn-primary:hover{filter:brightness(1.03)}
    .btn-tool{
      background: rgba(26,76,72,0.20);
      color: var(--text);
      margin-top:5px;font-size:12px;padding:10px 12px;
      border:1px solid rgba(26,76,72,0.45);
      cursor:pointer;border-radius:14px;font-weight:1100;
      transition:.15s;
    }
    .btn-tool:hover{background: rgba(26,76,72,0.30); border-color: rgba(182,193,105,0.40); transform: translateY(-1px)}

    /* Modal */
    #modal{
      display:none;position:fixed;top:50%;left:50%;
      transform:translate(-50%,-50%);
      background: rgba(7,23,22,0.92);
      border:1px solid rgba(182,193,105,0.55);
      padding:18px;border-radius: var(--radius);
      z-index:1000;width:92%;max-width:480px;
      box-shadow: 0 25px 70px rgba(0,0,0,.70);
      backdrop-filter: blur(10px);
    }
    #overlay{
      display:none;position:fixed;top:0;left:0;width:100%;height:100%;
      background:rgba(0,0,0,0.78);z-index:999
    }
    .breakdown-row{display:flex;justify-content:space-between;padding:8px 0;border-bottom:1px solid rgba(182,193,105,0.12);font-size:14px}

    /* Sticky add (mobile) */
    .sticky-add{
      display:none;position:fixed;bottom:12px;left:12px;right:12px;z-index:998;
      background: rgba(7,23,22,0.86);
      border:1px solid rgba(182,193,105,0.22);
      border-radius:18px;padding:10px;
      box-shadow: 0 18px 50px rgba(0,0,0,.45);
      backdrop-filter: blur(10px);
    }
    @media (max-width:1050px){.sticky-add{display:block} body{padding-bottom:120px}}

    /* PRINT */
    #printArea{display:none}
    @media print{
      nav,.no-print,.sticky-add,#status,.warn-banner{display:none!important}
      body{background:#fff;color:#000}
      .container{max-width:none}
      #map{display:none!important}
      #printArea{display:block}
      #printArea *{color:#000!important}
      #printArea h1,#printArea h2,#printArea h3{margin:0 0 8px 0}
      #printArea .pCard{border:1px solid #ccc;border-radius:10px;padding:12px;margin:10px 0}
      #printArea table{width:100%;border-collapse:collapse}
      #printArea th,#printArea td{border-bottom:1px solid #ddd;padding:8px;font-size:11px}
      #printArea .pGrid{display:grid;grid-template-columns:repeat(4,1fr);gap:10px}
      #printArea .pStat{border:1px solid #ddd;border-radius:10px;padding:10px}
      #printArea .right{text-align:right}
    }
  </style>
</head>
<body>

<div id="overlay" onclick="closeModal()"></div>
<div id="modal" role="dialog" aria-modal="true" aria-label="Trip Financials">
  <h3 style="margin-top:0;color:var(--accent)">Trip Financials</h3>
  <div id="modal-content"></div>
  <button class="btn btn-primary" onclick="closeModal()">Close</button>
</div>

<div id="printArea"></div>

<div class="container">
  <header class="topbar">
    <div class="brandWrap">
      <div class="logo">
        <!-- Put your logo file at assets/tag-logo.png -->
        <img src="assets/tag-logo.png" alt="Tag Trans Inc Logo">
      </div>
      <div class="brandText">
        <div class="brandTitle">TAG <span>DRIVER</span> PRO</div>
        <div class="brandSub">Tag Trans Inc ‚Ä¢ Dispatcher Command Center</div>
      </div>
    </div>

    <div class="controls no-print">
      <div class="control-block" style="min-width:240px;max-width:72vw;">
        <div class="mini">Driver</div>
        <select id="driverSelect" onchange="onDriverChange()"></select>
      </div>

      <button class="btnSmall primary" onclick="addDriver()">‚ûï Add Driver</button>
      <button class="btnSmall danger" onclick="removeDriver()">üóëÔ∏è Remove Driver</button>

      <div class="control-block" style="min-width:240px;max-width:72vw;">
        <div class="mini">Week</div>
        <select id="weekSelect" onchange="onWeekChange()"></select>
      </div>

      <button class="btnSmall primary" onclick="startNewWeek()">‚ûï Start New Week</button>
      <button class="btnSmall danger" onclick="resetCurrentWeek()">üßπ Clear This Week</button>

      <span class="pill">Local-only data</span>
    </div>

    <div id="status" class="status-msg">Processing...</div>
  </header>

  <div id="warn" class="warn-banner"></div>

  <nav class="no-print">
    <button class="nav-btn active" onclick="showTab('dashboard', this)">Dashboard & Map</button>
    <button class="nav-btn" onclick="showTab('analytics', this)">Analytics</button>
    <button class="nav-btn" onclick="showTab('companycut', this)">Company Cut</button>
    <button class="nav-btn" onclick="showTab('settings', this)">Settings & Costs</button>
  </nav>

  <!-- The rest of your app content + JS stays the same.
       IMPORTANT: Only change below in the JS:
       - Polyline color from #38bdf8 to var(--accent) (gold)
  -->

  <!-- DASHBOARD -->
  <div id="dashboard" class="tab-content active">
    <div class="stats-bar">
      <div class="stat-box"><div class="stat-label">Weekly Gross</div><div class="stat-val" id="wk_gross">$0.00</div></div>
      <div class="stat-box"><div class="stat-label">Weekly Miles</div><div class="stat-val" id="wk_miles">0</div></div>
      <div class="stat-box"><div class="stat-label">Net Profit</div><div class="stat-val pos" id="wk_profit">$0.00</div></div>
      <div class="stat-box"><div class="stat-label">Avg RPM (Gross)</div><div class="stat-val" id="wk_rpm">$0.00</div></div>
      <div class="stat-box"><div class="stat-label">Break-even RPM</div><div class="stat-val" id="wk_be_rpm">$0.00</div></div>
    </div>

    <div class="dash-grid">
      <div>
        <div class="card no-print">
          <div class="card-header">New Trip Entry</div>
          <div class="card-body">
            <div class="input-row">
              <div class="input-group"><label>Pickup</label><input id="origin" placeholder="City, State" autocomplete="off" /></div>
              <div class="input-group"><label>Drop</label><input id="dest" placeholder="City, State" autocomplete="off" /></div>
            </div>

            <div style="display:flex;gap:10px;margin-bottom:12px;flex-wrap:wrap;">
              <button class="btn-tool" onclick="calcRoute()">üì° Get Miles</button>
              <button class="btn-tool" onclick="verifyMap()">üó∫Ô∏è Verify</button>
              <button class="btn-tool" onclick="checkTolls()">üí∞ Tolls</button>
              <button class="btn-tool" onclick="swapCities()">üîÅ Swap</button>
            </div>

            <div class="input-row">
              <div class="input-group"><label>Loaded Mi</label><input id="mi_load" type="number" inputmode="numeric" min="0" step="1" oninput="preview()"></div>
              <div class="input-group"><label>Deadhead</label><input id="mi_dh" type="number" inputmode="numeric" min="0" step="1" oninput="preview()"></div>
              <div class="input-group"><label>Tolls ($)</label><input id="cost_tolls" type="number" inputmode="decimal" min="0" step="0.01" value="0" oninput="preview()"></div>
            </div>
            <div class="input-row">
              <div class="input-group"><label>Gross Pay ($)</label><input id="pay_gross" type="number" inputmode="decimal" min="0" step="0.01" oninput="preview()"></div>
            </div>

            <div style="background:rgba(0,0,0,0.28);padding:12px;border-radius:16px;margin-bottom:10px;text-align:center;border:1px solid rgba(182,193,105,0.18);">
              <span style="font-size:11px;color:var(--muted);text-transform:uppercase;font-weight:1000;">Trip Net Preview</span>
              <div id="preview_net" style="font-size:22px;font-weight:1200;color:var(--text);margin-top:4px;">$0.00</div>
              <div id="preview_hint" class="mini" style="margin-top:6px;"></div>
            </div>

            <button class="btn btn-primary" onclick="addLoad()">Add Load to Week</button>
            <div class="mini" style="margin-top:10px;">Driver split % can be overridden in Settings.</div>
          </div>
        </div>

        <div class="card no-print">
          <div class="card-header">Quick Actions</div>
          <div class="card-body" style="display:flex;gap:10px;flex-wrap:wrap;">
            <button class="btnSmall" onclick="copySummary()">üìã Copy Weekly Summary</button>
            <button class="btnSmall" onclick="exportCSV('week')">‚¨áÔ∏è Export Week CSV</button>
            <button class="btnSmall" onclick="printWeeklySummary()">üñ®Ô∏è Print Weekly Summary</button>
          </div>
        </div>
      </div>

      <div>
        <div class="card">
          <div class="card-header">Weekly Route Map</div>
          <div class="card-body" style="padding:0;">
            <div id="map"></div>
          </div>
        </div>
      </div>
    </div>

    <div class="card">
      <div class="card-header">Weekly Load Log</div>
      <div style="overflow-x:auto;">
        <table>
          <thead><tr><th>Route</th><th>Miles</th><th>Gross</th><th>Net</th><th>Gross RPM</th><th>Actions</th></tr></thead>
          <tbody id="loadList"></tbody>
        </table>
      </div>
    </div>
  </div>

  <!-- Keep your Analytics / Company Cut / Settings sections + JS below exactly as you had it -->
  <!-- Paste the rest of your existing HTML + JS here -->

</div>

<script>
/* ‚úÖ IMPORTANT:
   Keep your existing JavaScript.
   Only make this small change in initMap():
   Change polyline color to the Tag gold.

   Example replacements:
   - color: '#38bdf8'  ->  color: getComputedStyle(document.documentElement).getPropertyValue('--accent').trim()
*/

</script>
</body>
</html>
